<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>線上訂房 Booking</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/zh-tw.js"></script>

<link rel="stylesheet" href="assets/style.css">
</head>
<body>

<header>
  <h2>線上預約訂房</h2>
</header>

<section class="card">
  <label>入住日期</label>
  <input id="checkin" type="text" placeholder="選擇入住日期" readonly>
  
  <label>退房日期</label>
  <input id="checkout" type="text" placeholder="選擇退房日期" readonly>

  <button onclick="searchRooms()">查看可預訂房型 🔍</button>
</section>

<section id="rooms" class="room-list"></section>

<script>
flatpickr.localize(flatpickr.l10ns.zh_tw);
flatpickr("#checkin",{minDate:"today"});
flatpickr("#checkout",{minDate:"today"});

async function searchRooms(){
  const ci=document.getElementById("checkin").value;
  const co=document.getElementById("checkout").value;
  if(!ci||!co) return alert("請選擇日期");

  const res= await fetch(`/api/availability?start=${ci}&end=${co}`);
  const data= await res.json();

  document.getElementById("rooms").innerHTML=
    data.rooms.map(r=>`
    <div class="room-card">
      <img src="${r.images[0]}">
      <h3>${r.title}</h3>
      <p>${r.desc}</p>
      <span class="price">NT$${r.price}</span>
      <a href="booking.html?room=${r.id}&ci=${ci}&co=${co}">預訂</a>
    </div>
    `).join("");
}
</script>

</body>
</html>
